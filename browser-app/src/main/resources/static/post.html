<html>
    <head>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"
                integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
                crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
                crossorigin="anonymous"></script>
        <script>
            postLocal = function() {
                postTest('');
            };

            postRemote = function() {
                postTest($('#target').val());
            };

            postTest = function(baseurl) {
                var target = baseurl+'/demo/posttest';
                console.log("Posting to "+target);
                console.log($.cookie('SOFI_CSRF_COOKIE'));
                var out = $('#output');
                out.html('Posting to '+target);
                $.ajax({
                    url: baseurl+'/demo/posttest',
                    type: 'post',
                    data: 'send this back',
                    headers: {
                        'X-Csrf-Token': $.cookie('SOFI_CSRF_COOKIE')
                    },
                    success: function(data) {
                        out.html('Posted to '+target+' successfully! Data: <br><div style="border:1px solid; padding: 4px">'+data+'</div>');
                    },
                    error: function(xhr, status, error) {
                        out.html('Posted to '+target+' FAILED! Error: '+status+': '+error);
                    }
                });
            };
        </script>
    </head>
    <body>
        <h1>Post/CSRF tester</h1>
        <p>Tests CSRF protection provided by Bouncer.</p>
        <button onclick="postLocal()">Post local</button>
        <br>
        <h1>Remote tester</h1>
        <p>Tests remote host protection provided by Bouncer.</p>
        <input id="target" placeholder="https://dev-8.sofitest.com" type="text" style="width: 500px"/>
        <br>
        <button onclick="postRemote()">POST to Remote</button>
        <br>
        <h1>Multipart form post local tester</h1>
        <p>Tests multipart form data upload</p>
        <form action="/demo/upload" method="post" enctype="multipart/form-data">
            <p><input type="text" name="text" value="text default">
            <p><input type="file" name="file">
            <p><button type="submit">Submit</button>
        </form>
        <hr>
        <br>
        <h1>Output</h1>
        <div id="output"></div>
    </body>
</html>
